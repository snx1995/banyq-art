<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Banyq art</title>
    <link rel="stylesheet" href="./css/swiper.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        body, html {
            width: 100%;
            height: 100%;
            background-color: #2c3e50;
        }
        .swiper-container {
            width: 100%;
            height: 100%;
        }
        .slide-img {
            width: 100%;
            height: 100%;
        }
        path, circle {
            stroke: #ddd;
            stroke-width: 2px;
            fill: none;
            stroke-linejoin: round;
        }
        #grid {
            position: absolute;
            top: 0;
            left: 0;
        }
        #grid path {
            stroke: #666;
        }
        #svg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .svg-ani {
            stroke: #12CBC4;
            fill: none;
            filter: blur(40px);
            animation: loading 3s infinite linear;
        }
        .svg-bg {
            stroke: #fff;
            fill: none;
        }
        @keyframes loading {
            /* 0%, 100% {
                stroke-dashoffset: 155;
            }
            50% {
                stroke-dashoffset: 0;
            } */
            to {
                stroke-dashoffset: 0;
            }
        }
        .loading-overlay {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(ellipse at top, #1abc9c, transparent), radial-gradient(ellipse at bottom, #2980b9, transparent);
            z-index: 99999;
        }
        .loading-overlay.finished {
            display: none;
        }
    </style>
</head>
<body>
    <div class="swiper-container">
        <div class="swiper-wrapper">
            <div class="swiper-slide" style="background-color: #00b3ee;">
                <img class="slide-img">
            </div>
            <div class="swiper-slide" style="background-color: #e67e22;">
                <img class="slide-img">
            </div>
            <div class="swiper-slide" style="background-color: #2ecc71;">
                <img class="slide-img">
            </div>
            <div class="swiper-slide" style="background-color: #cc2e2e;">
                <img class="slide-img">
            </div>
        </div>
        <div class="swiper-pagination"></div>
    </div>
    <div class="loading-overlay">
        <svg width="200" height="200" id="svg">
            <path d="M100 180A80 80 0 1 1 180 100H168A12 12 0 1 0 152 92A48 48 1 0 0 96 92A12 12 0 1 0 80 100A52 52 0 0 0 100 180" class="svg-bg"/>
            <path d="M100 180A80 80 0 1 1 180 100H168A12 12 0 1 0 152 92A48 48 1 0 0 96 92A12 12 0 1 0 80 100A52 52 0 0 0 100 180" class="svg-ani"/>
        </svg>
    </div>
    <script src="./js/axios.min.js"></script>
    <script src="./js/swiper.min.js"></script>
    <script src="./js/load.js"></script>
    <script>
        window.onload = () => {
            const loadingOverlay = document.querySelector('.loading-overlay');

            loadingOverlay.addEventListener('transitionend', overlayListener, false);

            const swiper = new Swiper('.swiper-container', {
                direction: 'vertical',
                loop: false,
                pagination: {
                    el: '.swiper-pagination'
                }
            })
            const slideImgs = document.querySelectorAll('.slide-img');
            load(['./imgs/1.jpg', './imgs/2.jpg', './imgs/3.jpg', './imgs/3.jpg']).then(data => {
                slideImgs.forEach((img, i) => {
                    const url = URL.createObjectURL(data[i]);
                    img.src = url;
                })
                loadingOverlay.classList.add('finished')
            })
            // drawGrid();
            // draw(4);
            const path = document.querySelectorAll('.svg-ani');
            path.forEach(e => {
                const len = e.getTotalLength();
                const strikeLen = 50;
                e.style.strokeDasharray = `${strikeLen} ${len - strikeLen}`;
                e.style.strokeDashoffset = len;
            })
        
            function overlayListener() {
                loadingOverlay.removeEventListener('transitionend', overlayListener, false);
                loadingOverlay.style.display = 'none';
            }
        }
        function drawGrid() {
            const grid = document.createElement('svg');
            const svg = document.querySelector('#svg');
            grid.setAttribute('width', 400);
            grid.setAttribute('height', 400);
            for (let i = 0;i<= 40;i ++) {
                grid.appendChild(createPath(`M0 ${i * 10}H400`));
                grid.appendChild(createPath(`M${i * 10} 0V400`));
            }
            console.log(grid.innerHTML);
        }
        function draw(scale) {
            const svg = document.querySelector('#svg');
            const bg = `<path d="M${20 * scale + 20} ${40 * scale + 20}A${20 * scale} ${20 * scale} 0 1 1 ${40 * scale + 20} ${20 * scale + 20}H${37 * scale + 20}A${3 * scale} ${3 * scale} 0 1 0 ${33 * scale + 20} ${18 * scale + 20}A${12 * scale} ${12 * scale} 1 0 0 ${19 * scale + 20} ${18 * scale + 20}A${3 * scale} ${3 * scale} 0 1 0 ${15 * scale + 20} ${20 * scale + 20}A${13 * scale} ${13 * scale} 0 0 0 ${20 * scale + 20} ${40 * scale + 20}" class="svg-bg"></path>`;
            const ani = `<path d="M${20 * scale + 20} ${40 * scale + 20}A${20 * scale} ${20 * scale} 0 1 1 ${40 * scale + 20} ${20 * scale + 20}H${37 * scale + 20}A${3 * scale} ${3 * scale} 0 1 0 ${33 * scale + 20} ${18 * scale + 20}A${12 * scale} ${12 * scale} 1 0 0 ${19 * scale + 20} ${18 * scale + 20}A${3 * scale} ${3 * scale} 0 1 0 ${15 * scale + 20} ${20 * scale + 20}A${13 * scale} ${13 * scale} 0 0 0 ${20 * scale + 20} ${40 * scale + 20}" class="svg-ani"></path>`;
            svg.innerHTML = bg + ani;
        }
        function createPath(d, stroke) {
                const path = document.createElement('path');
                path.setAttribute('d', d);
                if (stroke) path.setAttribute('stroke', stroke);
                return path;
            }
    </script>
</body>
</html>